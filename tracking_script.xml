<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE MudletPackage>
<MudletPackage version="1.001">
	<ScriptPackage>
		<Script isActive="yes" isFolder="no">
			<name>Affliction tracking</name>
			<packageName></packageName>
			<script>tracker = require("tracking.script")
afflictions = require("tracking.afflictions")
targets = targets or {}

function targetting(who)
  targets = targets or {}
  targets[who] = targets[who] or tracker:new()
  targets[who].frozen = targets[who].frozen or 0
  return targets[who]
end


function tracker:get_afflictions(map)
  local t = {}
  for affliction, tb in pairs(self.afflictions) do
    if tb.confidence &gt; 0 and map(tb) then table.insert(t, affliction) end
  end
  
  return t
end

function tracker:get_affliction_confidence(afflictions)
  local t = 0
  local a = self.afflictions
  for _, v in ipairs(afflictions) do
    if a[v] then t = t + a[v].confidence end
  end
  return t
end

function tracker:freeze(n)
  self.frozen = self.frozen + n
  if self.frozen &gt; 3 then self.frozen = 3 end
  if self.frozen &lt; 0 then self.frozen = 0 end
end</script>
			<eventHandlerList />
		</Script>
	</ScriptPackage>
</MudletPackage>
